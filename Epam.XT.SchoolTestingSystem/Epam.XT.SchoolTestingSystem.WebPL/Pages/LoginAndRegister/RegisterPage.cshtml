@using Epam.XT.SchoolTestingSystem.WebPL.Models;
@using Epam.XT.SchoolTestingSystem.Common.Entities;
@using Epam.XT.SchoolTestingSystem.Dependencies;
@using Epam.XT.SchoolTestingSystem.BLL;
@{
    Layout = "~/Pages/Layouts/_BasicLayout.cshtml";
    var _userBLL = DependencyResolver.Instance.userBLL;
    bool loginExist = false;
}
@if (IsPost)
{
    string login = Request["login"];
    if (!(loginExist = _userBLL.IsLoginExist(login)))
    {
        string password = Request["password"];
        string name = Request["Name"];
        string surName = Request["SurName"];
        string role = Request["flexRadioDefault"];
        _userBLL.AddUser(new User(name, surName, login, HashCreator.GetHash(password), role));
        Response.Redirect("~/");
    }

}
@if (loginExist)
{
<div class="alert alert-warning" role="alert">
    Данный пользователь уже существует
</div>
}
<div class="container">
    <div class=row>
        <form method="post" class="col-sm-8 offset-2">
            <div class="form-group">
                <label for="exampleFormControlInput1">Login</label>
                <input name="login" type="text" required class="form-control" id="login">
            </div>
            <div class="form-group">
                <label for="exampleFormControlInput1">Password</label>
                <input name="password" type="password" required class="form-control" id="exampleFormControlInput1">
            </div>
            <div class="form-group">
                <label for="exampleFormControlInput1">Name</label>
                <input name="Name" type="text" required class="form-control" id="exampleFormControlInput1">
            </div>
            <div class="form-group">
                <label for="exampleFormControlInput1">SurName</label>
                <input name="SurName" type="text" required class="form-control" id="exampleFormControlInput1">
            </div>
            <div class="form-group">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" value="Teacher">
                    <label class="form-check-label" for="flexRadioDefault1">
                        Учитель
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" checked value="Apprentice">
                    <label class="form-check-label" for="flexRadioDefault2">
                        Ученик
                    </label>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
</div>